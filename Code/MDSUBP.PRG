******************************************************************************************************************
***PROCEDURE MDsubP
***EF : 3/24/15-CALLED FROM MENU
******************************************************************************************************************

PARAMETERS ntagSUB1, ccrtSUB1,ccrtSUB0, cAtName1, cnameinv1,  creqType1, ccounty1, mdep, mid, nMode

*!*	nMode=1 : COURT SET GENERATED BY TXN 19
*!*	nMode=2 : OLD WAY
*!*	nMode=0 : First Request -txn 11 use "G" subp
LOCAL lcselect AS STRING
lcselect =ALIAS()
LOCAL oMEDSUB AS OBJECT
oMEDSUB = CREATEOBJECT("medtimesheet")
STORE "" TO lcPDist, lcPDiv
mdefendant = ALLT(pc_dfcaptn)
szPltName = IIF( pl_ofcHous, pc_plnam, pc_plcaptn )
*mTerm =  pd_term
LOCAL c_term AS STRING
c_term=""
&&08/29/13 - use month year per Liz
c_term=termdate(pd_term)
mTerm=c_term
IF TYPE( "MV") = "U"
	PUBLIC MV
	mv=""
ENDIF
mRDocket = pc_docket
llProvider = IIF( creqType1 = "S", pl_c1Prvdr, .F.)




IF pl_c1Form OR pl_NJSub &&6/27/2011 NJ SUBPOENA
	SELECT court
	c_order=ORDER()
	IF EMPTY(ALLTRIM(c_order))
		=CURSORSETPROP("KeyFieldList", "COURT", "COURT")
		INDEX ON court TAG court ADDITIVE
	ENDIF
	SET ORDER TO court
	SEEK pc_Court1
	bBalt = (pc_c1Name = "MD-BaltimoCity")
	TxNotFed = ( SEEK( ALLT( pc_Court2)))
	IF creqType1 <> "A" AND (pl_ofcMD OR pl_MdAsb) AND nMode=2
	**3/24/15 MD SUBP
		LOCAL l_NoMdProof AS Boolean
		l_NoMdCert=oMEDSUB.sqlexecute("SELECT dbo.fn_NoMdCert('" + fixquote(pc_rqatcod) + "')", "NoMdCert")
		l_NoMdProof=IIF(l_NoMdCert,NoMdCert.EXP, .F.)

		IF NOT l_NoMdProof 
			DO MDProof IN subp_pa WITH ntagSUB1, pc_platcod
		ENDIF
	ENDIF

	IF ( LEFT( ALLTRIM(pc_Court1), 4) = "USDC"  )
		DO PrintGroup WITH mv, "SubpoenaUSDC" &&all usdc like sub print the same form as 03/08/12
	ELSE
	DO CASE 
	CASE   nMode<>0   OR TYPE ('nMode')='U'
		** --- 08/03/2020 MD #173172 -----------------------------------
		DO CASE 
		 CASE pl_ILCook=.T.
			Do PrintGroup With mv,"SubpoenaIL-All"
		CASE plCourtIN=.T.
			** --- 08/05/2020 MD #170629 ----------------------------------- 
			Do PrintGroup With mv,"SubpoenaIN-All"
		OTHERWISE 
			DO PrintGroup WITH mv, "Subpoena" + ;
			IIF( pl_MichCrt, "MI-Courts", ALLT( ccrtSUB1))
		ENDCASE 
	CASE   nMode=0 && FIRST REQUEST -G TYPE		
			ntag= ntagSUB1
			DO pspecdoc IN subp_pa WITH 'G'			
			RELEASE oMEDSUB
			IF NOT EMPTY(lcselect)
			SELECT (lcselect)
			ENDIF
			RETURN
			
			
	ENDCASE
	ENDIF

ELSE
	DO CASE 
	   CASE pl_ILCook=.T.
			Do PrintGroup With mv,"SubpoenaIL-All"
	   CASE plCourtIN=.T.
			** --- 08/05/2020 MD #170629 ----------------------------------- 
			Do PrintGroup With mv,"SubpoenaIN-All"
	   OTHERWISE 
		&&03/11/13 ADDED KOP GENERIC FORMS ( ONE FOR THE NOTICE SET AND ONE FOR COURT SET) :"HoldPrint" Project.
		   IF pc_RpsForm="KOPGeneric"
			LOCAL c_scanpcx AS STRING, c_riderpcx AS STRING
			STORE "" TO c_scanpcx, c_riderpcx
	&&05/23/13- print a scanned subpena page with a court set and rps forms with notices and court sets for signing a subp
			IF (pl_noticng   AND  TYPE('pd_dateCourtset')<>"D" )  &&OR 	 pl_Reissue	 &&- , Reissue  Also (12/18/13)
				DO PrintGroup WITH mv, IIF(NOT pl_HSubpCourt , "PAGen_Notice", "PAGen_Court")
			ELSE

	**10/17/13 - USE THE SAME LOGIC WHEN REPRINTING A HOLDSUBPS


				IF PL_1ST_REQ  OR pl_UpdHoldReqst  && USE A FAKE PATH FOR FUTURE REQUEST

					DO PrintGroup WITH mv, "ScannedSub"
					c_scanpcx=FakeSubPcx(ntagSUB1)
					DO PrintField WITH mv, "Id", c_scanpcx
					DO PrintField WITH mv, "RT", "RT: " + pc_lrsno 	+ "." + ALLT(STR(ntagSUB1))
					RELEASE oMEDSUB
					IF NOT EMPTY(lcselect)
						SELECT (lcselect)
					ENDIF
				ELSE
						ntag= ntagSUB1
						DO pspecdoc IN subp_pa WITH 'G'
	*!*					ENDIF
				ENDIF
				RETURN
			ENDIF


	******************************03/11/13 ADDED KOP GENERIC FORMS*****************************

		ELSE
			DO PrintGroup WITH mv, ;
				IIF( pl_ofcHous AND TxNotFed, "TXSubpoena", "SubpoenaOther")

			DO PrintField WITH mv, "RT", pc_lrsno + "." + ALLT(STR(ntagSUB1))
		ENDIF
	ENDCASE  && pl_ILCook=.T.
ENDIF




IF llProvider AND TxNotFed
	IF USED("REQUEST")
		SELECT REQUEST


		lcPDist = DISTRICT
		lcPDiv  = division
		IF NOT "DIVISION" $ UPPER( lcPDiv)
			lcPDiv = ALLT( lcPDiv) + " Division"
		ENDIF
	ENDIF

	DO PrintGroup WITH mv, "Provider"
	DO PrintField WITH mv, "Dist", lcPDist
	DO PrintField WITH mv, "Div", lcPDiv

	l_ST=oMEDSUB.sqlexecute("SELECT dbo.gfState('" + IIF(EMPTY(ALLTRIM(pc_depofile.state)),"PA",ALLTRIM(pc_depofile.state)) + "')", "DepSt")
	lc_State=IIF(l_ST,DepSt.EXP, "")
	DO PrintField WITH mv, "State", ALLTRIM(lc_State)
	DO PrintField WITH mv, "CaseDist", pc_distrct
	DO PrintField WITH mv, "CaseDiv", IIF (ISNULL(pc_mfcture),pc_divisn,pc_mfcture)
ENDIF

IF pc_RpsForm <> "Blank"




&&EF 09/24/03 Civil Lit Reissue should print 'original' subp req date
	IF pl_Hipaa AND pl_Reissue
		mdate = gfChkDat( fOrigIss( pn_Suppto) + 20, .F., .F.)
		pd_maild = gfChkDat( fOrigIss( pn_tag), .F., .F.)
	ENDIF
	



	
	ldtxn11 = gfChkDat( fOrigIss(IIF(pl_Reissue, pn_Suppto,pn_tag)), .F., .F.)
	IF TYPE("mdate")<>"D"
		mdate = gfChkDat( fOrigIss( pn_tag), .F., .F.)
	ENDIF
	mdate= mdate

	LDXN19=   Get19Date(PC_CLCODE, pn_tag) 
	
	ldIssue=  gfChkDat( LDXN19+1, .F.,.F.)

	DO PrintField WITH mv, "RequestDate",  IIF(bBalt, DTOC(ldIssue)   ,DTOC(ldtxn11))

&& Add suffix to convert date to an ordinal number (first, second, etc.)
	IF pl_ofcHous AND TxNotFed
		DO PrintField WITH mv, "StrAdd", ;
			gfOrdNum( IIF ( pl_ofcHous AND NOT PL_1ST_REQ, ldtxn11, d_today))
	ENDIF
	DO PrintField WITH mv, "Loc", ;
		IIF(pl_ofcMD OR pl_ofcPgh, "P", pc_Offcode)
**08/08/03 Print consolidation info for MD-Baltimore filings only
	IF bBalt

		DO PrintField WITH mv, "ConsCase", IIF( NOT ISNULL( pc_mfcture), ;
			"Consolidation Case No: " + pc_mfcture, "")
		DO PrintField WITH mv, "RoleP",IIF( pl_plisrq, "X", "")
		DO PrintField WITH mv, "RoleD",IIF( pl_plisrq, "", "X")
		DO PrintField WITH mv, "RT", ALLTRIM(pc_lrsno) + "." +ALLTRIM( STR(pn_tag))
		
		** 6/12/15: added rq atty line
		LOCAL c_Atycsz as String
			c_Atycsz=""
			c_Atty =fixquote(pc_rqatcod)
			pl_GetAt = .F.
			DO gfatinfo WITH c_Atty, "M"
			c_Atycsz= pc_Aty1Ad + ' ' + pc_Aty2Ad + ' ' + pc_Atycsz
			DO PrintField WITH mv, "Atycsz", ALLTRIM(c_Atycsz)
		

	ENDIF
**08/08/03
IF bBalt
	DO PRINTGROUP WITH MV, "Plaintiff"
	DO PRINTFIELD WITH MV, "FirstName", ALLTRIM( PC_PLNAM)
	DO PRINTFIELD WITH MV, "MidInitial", ""
	DO PRINTFIELD WITH MV, "LastName", ""
	 IF TYPE('pd_pldob')<>"C"
		PD_PLDOB=DTOC(PD_PLDOB)
	ENDIF	
	DO PRINTFIELD WITH MV, "BirthDate",  LEFT(PD_PLDOB,10)
	DO PRINTFIELD WITH MV, "SSN", PC_FULLSSN &&pc_plssn

ENDIF
	IF TYPE( "ldDueDate") = "D" OR TYPE( "ldDueDate") = "T"
		IF (DTOC(ldDueDate))<>"  /  /    "
			dep_date = ldDueDate
		ENDIF
	ENDIF
LOCAL  mCrtDesc
       mCrtDesc=""
	c_cl=	pc_clcode
	n_tg=pn_tag

	IF 	nMode=2  &&3/24/15 Md sub
		pd_DueDate= GetReqDueDate(c_cl, n_tg, IIF(TYPE("dep_date")="T", TTOD(dep_date),dep_date))
	ELSE
		ldDue=  gfChkDat( LDXN19+45, .F.,.F.)	
		*  IIF(bBalt, DTOC(ldIssue)   ,DTOC(ldtxn11))
		pd_DueDate=ldDue
	endif



	IF pl_MichCrt
		ldBusOnly = MIDueDat( IIF( l_Reprint, sztxndate + 1, d_today + 1))
	ENDIF



	DO PrintField WITH mv, "DepDate", ;
		IIF( pl_MichCrt OR pl_NJSub , DTOC( ldBusOnly), DTOC (pd_DueDate))


	IF bBalt OR ('MD-'$pc_c1Name) 


		DO PrintField WITH mv, "DepDateDayWeek",  CDOW(pd_DueDate)
		DO PrintField WITH mv, "DepDateDayMonth",  DAY(pd_DueDate)
		DO PrintField WITH mv, "DepDateMonth",  WhatMonthIsIt( MONTH(pd_DueDate))
		DO PrintField WITH mv, "DepDateYear", YEAR(pd_DueDate)


	ENDIF

	IF TYPE('szEdtReq')="U"
		IF USED("Spec_ins")
			SELECT Spec_ins
			USE
		ENDIF
		oMEDSUB.sqlexecute("Exec [dbo].[GetTheLatestBlurb] '" + fixquote(pc_clcode) + "',' " + STR(pn_tag) + "'", "Spec_ins")
		szEdtReq=gfAddCR( Spec_ins.spec_inst)
	ENDIF


	IF EMPTY( ALLTRIM(szEdtReq))
		szEdtReq = gfAddCR( szrequest)
	ENDIF
**04/16/2010- RE-SPACE THE BLURB
	DO PrintField WITH mv, "InfoText",  STRTRAN( STRTRAN( szEdtReq, CHR(13), " "), CHR(10), "")


	DO PrintGroup WITH mv, "Case"
	DO PrintField WITH mv, "Plaintiff", szPltName
	DO PrintField WITH mv, "Defendant", mdefendant
	DO PrintField WITH mv, "AttyType", IIF( pl_plisrq, "P", "D")
**06/04/2013 USDC PRINTS signature
	oMEDSUB.CLOSEALIAS("AttySign")
	l_Ok=oMEDSUB.sqlexecute("SELECT dbo.AttySignature('" + fixquote(pc_rqatcod) + "')", "AttySign")
	c_attysign=""
	IF NOT l_Ok
		c_attysign=IIF(EMPTY(ALLTRIM(pc_AtySign)), cnameinv1,pc_AtySign)
	ELSE
		c_attysign=fixquote(AttySign.EXP)
	ENDIF
	**06/08/15: added CR Phone# per Liz (MD subps)
	local c_CRphn  as String
	c_CRphn="" 
	IF EMPTY(ALLTRIM(pc_amgr_ph))
		oMEDSUB.closealias("CRAcct")
		oMed.sqlexecute("exec  DBO.[GetUserByLogin] '" +	ALLTRIM( pc_amgr_id) + "'", "CRAcct")
		SELECT CRAcct
		IF NOT EOF()
		c_CRphn= ALLT( CRAcct.DirectDial)		
		ENDIF
	ELSE
	
	c_CRphn=pc_amgr_ph	
		
	ENDIF		
***Signature added
	DO PrintField WITH mv, "AttyName", ALLTRIM(c_attysign) + "  " + c_CRphn
	DO PrintField WITH mv, "Docket", mRDocket
	DO PrintField WITH mv, "Court", IIF(pc_RpsForm="KOPGeneric" , ALLTRIM( ccounty1 ),ccrtSUB1 ) &&08/29/13 PER lIZ USE SOOUNTY FOR KOPGENERIC COURTS
	DO PrintField WITH mv, "Court2", IIF(pl_ofcHous AND creqType1="S", ;
		pc_Court2, IIF(pl_NJSub,PROPER(ccounty1),ccrtSUB0))

	DO PrintField WITH mv, "County", UPPER(IIF(pl_ofcHous AND creqType1="S", ;
		pc_plcnty, ccounty1))
	DO PrintField WITH mv, "Term", mTerm
* ------------------------------------------------------------
**02/29/12 All KOP litigation use the same USDC form && removed AND pc_Litcode='C  '
**09/17/09 all USDC courts follow the same rule


	IF ( LEFT( ALLTRIM(pc_Court1), 4) = "USDC" ) && AND NOT pl_CAVer )
**4/16/09 USDC edit per Liz'a request - do not print "NONE" district
		DO PrintField WITH mv, "Dist", IIF(ALLTRIM(pc_tagdist)='NONE', '',ALLT( pc_tagdist))
	ELSE
		DO PrintField WITH mv, "Dist", ALLT( pc_distrct)
	ENDIF


**02/29/12 All KOP litigation use the same USDC form && removed AND pc_Litcode='C  '
**09/17/09 all USDC courts follow the same rule
	IF ( LEFT( ALLTRIM(pc_Court1), 4) = "USDC" ) && AND NOT pl_CAVer )
**4/16/09 -edit USDC per Liz's request
**11/12/14- use a part of a court's description  per Liz
		c_court=""
		nlen=0
		nlen= LEN(ALLTRIM(pc_c1Desc))
		c_court=RIGHT( ALLTRIM(pc_c1Desc), nlen-7) 
		DO PrintField WITH mv, "Area", c_court
		*DO PrintField WITH mv, "Area",  "Filed in : " + ALLTRIM(pc_c1Desc)
	ELSE
		DO PrintField WITH mv, "Area", mCrtDesc
	ENDIF
	IF TYPE('pd_pldob')<>"C"
		pd_pldob=DTOC(pd_pldob)
	ENDIF
	DO PrintField WITH mv, "BirthDate",  LEFT(pd_pldob,10)
	DO PrintField WITH mv, "SSN", pc_plssn
	IF pl_ofcHous AND TxNotFed
		DO PrintField WITH mv, "Extra", TRIM( pc_maiden1)
	ENDIF

	IF LEFT( ALLTRIM(pc_Court1), 4) = "USDC"  AND pl_c1Form &&09/17/09
		DO PrintField WITH mv, "FullName",  pc_plnam
		DO PrintField WITH mv, "DepoState", UPPER(getstatename(ALLTRIM(pc_depofile.state)))
		DO PrintField WITH mv, "FirmName", cnameinv1

	ENDIF
	DO pDepInfo  IN subp_pa WITH mid, PROPER( mdep), .F.


IF  nMode=2 &&3/24/15 MD sub

	IF TxNotFed OR pl_ILCook 
		DO PrintGroup WITH mv, "Atty"
		DO PrintField WITH mv, "Name_inv", cnameinv1
		DO PrintField WITH mv, "Ata1", mratadd1
		DO PrintField WITH mv, "Ata2", mratadd2
		DO PrintField WITH mv, "Atacsz", mratcsz
		DO PrintField WITH mv, "Phone", mphone
**09/18/07- print a firm's name with the USDC subs.
		IF LEFT( ALLTRIM(pc_Court1), 4) = "USDC"  &&09/17/09
			DO PrintField WITH mv, "Ata3", pc_AtyFirm
		ENDIF
**9/18/07 -end
	ENDIF


	IF pl_c1Form
		DO PrintField WITH mv, "PLAtty", szPlAtty
	ENDIF
ENDIF &&3/24/15 MD sub
	IF pl_ofcMD AND ALLTRIM( pc_Court1) = "MD-HCA"
		STORE "" TO szPlAtty, mnameinvP, mratadd1P, mratadd2P, mratcszP, mphoneP, mCrtDesc
		IF NOT EMPTY( pc_platcod)
			c_plAtty =fixquote(pc_platcod)
			pl_GetAt = .F.
			DO gfatinfo WITH c_plAtty, "M"

			szPlAtty =pc_AtyName
			mnameinvP = pc_AtySign
			mratadd1P = pc_Aty1Ad
			mratadd2P = pc_Aty2Ad
			mratcszP = pc_Atycsz
			mphoneP = pc_AtyPhn

		ENDIF

		DO PrintGroup WITH mv, "PLAtty"
		DO PrintField WITH mv, "Ata12", mratadd1P
		DO PrintField WITH mv, "Ata22", mratadd2P
		DO PrintField WITH mv, "Atacsz2", mratcszP
	ENDIF
ENDIF                                        &&12/10/02 MD subp

&&EF 10/17/02, 11/12/02:  Michigan subpoenas print special fields plus pl_ILCook as 1/16/2013
** --- 08/05/2020 MD #170629 added OR plCourtIN=.T. ----------------------------------- 
IF pl_MichCrt OR pl_ILCook OR plCourtIN=.T.			
	lcAlias = SELECT()
	lc_RqAtty=fixquote(pc_rqatcod)
	l_BarNum=oMEDSUB.sqlexecute("SELECT dbo.fn_AttyBarNum('" + lc_RqAtty + "')", "AtBarNum")
	lc_BarNum=IIF(l_BarNum,AtBarNum.EXP, "")
	SELECT ( lcAlias)
	IF TYPE('pd_pldob')<>"C"
		pd_pldob=DTOC(pd_pldob)
	ENDIF
	IF pl_ILCook
	    *  -- 09/09/2019 MD #143028
		*  -- lc_RecPertain = pc_plnam + " DOB: " +  LEFT(pd_pldob,10) + " SSN:" + pc_fullssn
		lc_RecPertain = pc_plnam
	ELSE
		lc_RecPertain = pc_plnam + CHR(13) + "DOB: " +  LEFT(pd_pldob,10) +CHR(13) + ;
			"RT#: " + pc_lrsno + " Tag #: " + ALLTRIM( STR( ntagSUB1))
	ENDIF
	IF  plCourtIN=.T.
		DO PrintField WITH mv, "BarNo", lc_BarNum
		DO PrintField WITH mv, "IssueDate", DTOC( mdate)
	ELSE 
		DO PrintField WITH mv, "RecPertain", lc_RecPertain
		DO PrintField WITH mv, "BarNo", lc_BarNum
		IF pl_ILCook
			DO PrintField WITH mv, "ClientRep", ALLTRIM(pc_amgr_nm)
			DO PrintField WITH mv, "IssueDate", DTOC( mdate)
			DO PrintField WITH mv, "Id", pc_ScanSg

		ENDIF
	ENDIF 
ENDIF



**02/29/12 All KOP litigation use the same USDC form && removed AND pc_Litcode='C  '
**03/11/14- PRINT EXIBIT A WITH NOTICES/ORDER VERIFICATIONS
IF (LEFT( ALLTRIM(pc_Court1), 4) = "USDC") && AND NOT bNotcall && DO NOT PRINT AN ATTACMENT FOR NOTICES (KOP ONLY, BUT PRINT FOR THE CA)

	IF pl_kopVer =.T. AND NOT bNotcall
** DO NOT PARINT THAT PAGE WITH  NOTICES
		DO PrintGroup WITH mv, "USDCPage2"
	ENDIF


	IF pl_CAVer =.T. AND NOT pl_CANotc
** DO NOT PARINT THAT PAGE WITH THE CA NOTICES
		DO PrintGroup WITH mv, "USDCPage2"
	ENDIF
	
	
&&3/25/14-rider can be a stored 'Return" image now 	
LOCAL C_RIDERPCX AS String
C_RIDERPCX=""
C_RIDERPCX=SUBRIDERPCX	(pN_TAG,"R",1 )
IF !EMPTY(ALLTRIM(C_RIDERPCX))
	ntag= pn_tag
	DO pspecdoc IN subp_pa WITH 'R'

ELSE

	
	
	DO PrintGroup WITH mv, "ExhibitUSDC"
**04/16/2010- Respace the blurbs
	IF TYPE('szEdtReq')="U"
		IF USED("Spec_ins")
			SELECT Spec_ins
			USE
		ENDIF
		oMEDSUB.sqlexecute("Exec [dbo].[GetTheLatestBlurb] '" + fixquote(pc_clcode) + "',' " + STR(pn_tag) + "'", "Spec_ins")
		szEdtReq=gfAddCR( Spec_ins.spec_inst)
	ENDIF



	DO PrintField WITH mv, "InfoText",  STRTRAN( STRTRAN( szEdtReq, CHR(13), " "), CHR(10), "")
	DO PrintField WITH mv, "CaseplCap", szPltName
	DO PrintField WITH mv, "CasedefCap", mdefendant
	DO PrintField WITH mv, "CaseDocket", mRDocket
	DO PrintField WITH mv, "ControlLrsNo", STR(pn_lrsno)
	DO PrintField WITH mv, "ControlTag" , STR( pn_tag)
	DO PrintField WITH mv, "Deponent" , mdep
	lc_RecPertain=""
	lc_RecPertain = pc_plnam + "  DOB: " +  LEFT(pd_pldob,10) +  "  SSN: " + ALLTRIM( pc_plssn)
	DO PrintField WITH mv, "Pertain" , lc_RecPertain

ENDIF   &&3/25/14-rider by image 

ENDIF



IF pl_kopVer AND ALLTRIM(pc_Court1)='IL-WCC'
*****
	DO PrintGroup WITH mv, "Plaintiff"

* DMA 05/25/04 Switch to long plaintiff name
	DO PrintField WITH mv, "FirstName", pc_plnam
	DO PrintField WITH mv, "MidInitial", ""
	DO PrintField WITH mv, "LastName", ""
	DO PrintField WITH mv, "Addr1", pc_pladdr1
	DO PrintField WITH mv, "Addr2", pc_pladdr2
	IF TYPE('pd_pldob')<>"C"
		pd_pldob=DTOC(pd_pldob)
	ENDIF
	IF TYPE('pd_pldod')<>"C"
		pd_pldod=DTOC(pd_pldod)
	ENDIF

	DO PrintField WITH mv, "BirthDate", LEFT(pd_pldob,10)
	DO PrintField WITH mv, "SSN", ALLT( pc_plssn)
	DO PrintField WITH mv, "DeathDate",  LEFT(pd_pldod,10)
	DO PrintField WITH mv, "Extra", ""

****
ENDIF


** ---  01/29/2021 MD #222170 
IF TXNotFed
	LOCAL inDefendantName
	STORE "" TO inDefendantName	
	oMEDSub.closealias("viewDefName")
	SELECT 0
	oMEDSub.sqlexecute("exec dbo.AttyDefInfo '" + fixquote(pc_clcode)+ "', "+ALLTRIM(STR(pn_tag))+", '"+Iif( pl_plisrq, "P", "D")+"'", "viewDefName")
	IF USED("viewDefName")			
	   	GO TOP 		   
	   	inDefendantName=ALLTRIM(DefendantName) 		   
	Endif	
	oMEDSub.closealias("viewDefName")
	Do PrintField With mv, "DefendantName", inDefendantName	
ENDIF 
** ---  01/29/2021 MD #222170 

***EF 11/07/08 PAGE 2 FOR CIVIL LIT usdc
RELEASE oMEDSUB
IF NOT EMPTY(lcselect)
	SELECT (lcselect)
ENDIF
RETURN
***************************************************************************
FUNCTION WhatMonthIsIt()
PARAMETERS nId
PRIVATE c_month AS STRING
c_month =''
c_month= laMonth[nId ]
RETURN c_month
***************************************************************************
